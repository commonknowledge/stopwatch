{% extends "base.html" %}
{% load django_bootstrap5 static ckbootstrap_tags wagtailcore_tags ckdjango_tags wagtailembeds_tags wagtailimages_tags %}

{% block content %}

{% if self.newsflash %}
<div class="container container-outline" id="news-ticker">
</div>
{% endif %}

<header class="position-relative container container-outline container-outline-btm p-0">
  <div class="row gx-0">
    {% if self.style == 'ROWS' %}
      <div class="col-md-3 col-lg-2"></div>
    {% endif %}

    {% if self.photo and self.style == 'GRID' %}
      <div class="col-8 col-md-4">
        {% if self.show_header_image %}
          {% image self.photo height-500 class="img-fit" %}
        {% endif %}
      </div>
      
      <div class="col-8 col-md-4 order-md-first pt-5 py-3 py-md-7 px-3 streamfield-compact">
        <h1 class="heading-xlarge">{{self.title}}</h1>
        
        {{self.description|richtext}}
      </div>
    {% else %}
      <div class="col flex-column flex-md-row p-3">
        <h1 class="mt-3 mt-md-5 mb-0 mb-md-3">{{self.title}}</h1>
        {% if self.description %}
          <div class="heading-medium mb-5 subheading-maxwidth">
            {{self.description}}
          </div>
        {% endif %}
      </div>
    {% endif %}
  </div>
</header>

<main class="container container-outline pb-5 pt-md-3">
  <div class="row">
    {% include "stopwatch/includes/filters.html" with style=self.style tags=filter_form.theme sort=filter_form.sort searchable=self.searchable class="pb-5 pb-md-0" only %}

    <div class="col" {% infinite_scroll_container %}>
      {% if self.style == 'ROWS' %}
        <div class="border-bottom border-1 border-primary d-md-none"></div>
      {% endif %}
      {% if page.pinned_pages %}
      {% include "stopwatch/includes/pinned_pages.html" with pinned_pages=page.pinned_pages pinned_pages_style=page.pinned_pages_style only %}
      {% endif %}

      {% include "stopwatch/includes/article_list.html" with pages=child_list_page style=self.style search_query=filter_form.query.value reset_url=self.url only %}
    </div>
  </div>
</main>

{% endblock content %}


{% block extra_js %}
{% bind_filter_form %}

{% if self.newsflash %}
  {% include "stopwatch/includes/news_ticker_js.html" with id="news-ticker" items=self.featured_items only %}
{% endif %}

{% endblock %}
